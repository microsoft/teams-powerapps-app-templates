"'Topics Screen' As screen":
    Fill: =gblAppStyles.Background.Fill
    OnVisible: |-
        =Concurrent(
            ClearCollect(
                colDiscussionResponsesLast7Days,
                Filter(
                    'Discussion Responses',
                    'Discussion Responses (Views)'.'Last 7 Days Discussion Responses'
                )
            ),
            ClearCollect(
                colDiscussions,
                Filter(
                    Discussions,
                    'Discussions (Views)'.'Active Discussions'
                )
            )
        );
        Clear(colDiscussionResponses);
        ForAll(
            colDiscussionResponsesLast7Days,
            Collect(
                colDiscussionResponses,
                {DiscussionGUID: Discussion.Discussion}
            )
        );
        ClearCollect(
            colGroupedResponsesByDiscussion,
            DropColumns(
                AddColumns(
                    GroupBy(
                        colDiscussionResponses,
                        "DiscussionGUID",
                        "GroupedResponsesByDiscussion"
                    ),
                    "ResponseCount",
                    CountRows(GroupedResponsesByDiscussion)
                ),
                "GroupedResponsesByDiscussion"
            )
        );
        Clear(colMostEngagingDiscussions);
        ForAll(
            colGroupedResponsesByDiscussion,
            Collect(
                colMostEngagingDiscussions,
                {
                    DiscussionRecord: LookUp(
                        colDiscussions,
                        //Discussions,
                        Discussion = DiscussionGUID
                    ),
                    NumberOfResponses: ResponseCount
                }
            )
        )

    lblAnnounce_Topics_1 As label:
        Height: =0
        Live: =Live.Assertive
        Text: =locScreenReaderAnnouncedText
        Width: =0
        X: =Parent.Width - Self.Width
        Y: =Parent.Height - Self.Height
        ZIndex: =1

    conTopics As groupContainer:
        DisplayMode: =DisplayMode.Edit
        Height: =Parent.Height
        LayoutAlignItems: =LayoutAlignItems.Start
        LayoutDirection: =LayoutDirection.Horizontal
        LayoutJustifyContent: =LayoutJustifyContent.Start
        LayoutMode: =LayoutMode.Manual
        LayoutOverflowX: =LayoutOverflow.Hide
        LayoutOverflowY: =LayoutOverflow.Hide
        Width: =Parent.Width
        X: =0*1
        Y: =0*1
        ZIndex: =2

        cnvTopics As fluidGrid.fluidGridWithBlankCard:
            BorderThickness: =0
            Height: =Parent.Height
            Width: =Parent.Width
            X: =0*1
            Y: =0*1
            ZIndex: =1

            dtcTopics As dataCard:
                BorderColor: =RGBA(0, 0, 0, 1)
                BorderStyle: =BorderStyle.Solid
                BorderThickness: =0
                DisplayMode: =DisplayMode.Edit
                Fill: =RGBA(0, 0, 0, 0)
                Height: =Parent.Height
                Width: =Parent.Width
                X: =0
                Y: =0
                ZIndex: =1

                galActiveDiscussions As gallery.galleryVertical:
                    AccessibleLabel: ="Gallery of most active discussions"
                    FocusedBorderThickness: =1
                    Height: =Self.TemplateHeight * CountRows(Self.AllItems)
                    Items: |-
                        =FirstN(
                            Sort(
                                colMostEngagingDiscussions,
                                NumberOfResponses,
                                Descending
                            ),
                            3
                        )
                    Layout: =Layout.Vertical
                    OnSelect: |-
                        =UpdateContext(
                            {
                                locSelectedDiscussion: LookUp(
                                    Discussions,
                                    Discussion = ThisItem.DiscussionRecord.Discussion
                                )
                            }
                        );
                        UpdateContext(
                            {
                                locSelectedDiscussionCreatedByUserFullName: LookUp(
                                    Users,
                                    User = locSelectedDiscussion.'Created By'.User,
                                    'Full Name'
                                )
                            }
                        );
                        Navigate(
                            'Responses Screen',
                            ScreenTransition.Fade,
                            {
                                locSelectedDiscussion: locSelectedDiscussion,
                                locSelectedDiscussionCreatedByUserFullName: locSelectedDiscussionCreatedByUserFullName,
                                locNavFromTopic: true
                            }
                        )
                    TabIndex: =0
                    TemplatePadding: =0
                    TemplateSize: |-
                        =If(
                            'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                            99 * 1,
                            141 * 1
                        )
                    Width: =galTopics.Width
                    X: =galTopics.X
                    Y: =lblActiveDiscusionsHeader.Y + lblActiveDiscusionsHeader.Height + 20
                    ZIndex: =1

                    btnActiveDiscussionBackground As button:
                        BorderThickness: =0
                        Color: =Transparent
                        DisabledBorderColor: =Self.BorderColor
                        DisabledColor: =Self.Color
                        DisabledFill: =Self.Fill
                        Fill: |-
                            =If(
                                gblThemeDark,
                                gblAppColors.NeutralWebGray220,
                                gblThemeHiCo,
                                Black,
                                White
                            )
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Height: =Parent.TemplateHeight - 18
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =Self.Fill
                        OnSelect: =Select(Parent)
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =Self.Color
                        PressedFill: =Self.Fill
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Size: =gblAppStyles.ButtonTransparent.Size
                        TabIndex: =-1
                        Text: |-
                            =With(
                                {
                                    varDefault: "Background button for the discussion",
                                    varOOBTextId: "btnActiveDiscussionBackground__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Tooltip: =Self.Text
                        Width: =Parent.TemplateWidth - Self.X*2
                        X: =5*1
                        Y: =5
                        ZIndex: =1

                    lblActiveDiscussionName As label:
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingTop: =10
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: =ThisItem.DiscussionRecord.Name
                        VerticalAlign: =VerticalAlign.Bottom
                        Width: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                txtActiveDiscussionTopic.X - 20,
                                Parent.Width - Self.X*2
                            )
                        Wrap: =false
                        X: =5*1
                        Y: =12*1
                        ZIndex: =2

                    lblActiveDiscussionCreatedBy As label:
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Small
                        Text: |-
                            =ThisItem.DiscussionRecord.'Created By'.'Full Name' & " " & Text(
                                ThisItem.DiscussionRecord.'Created On',
                                "[$-en-US]mm/dd"
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                txtActiveDiscussionTopic.X - 20,
                                Parent.Width - Self.X*2
                            )
                        Wrap: =false
                        X: =5*1
                        Y: =lblActiveDiscussionName.Y + lblActiveDiscussionName.Height
                        ZIndex: =3

                    imgActiveDiscussionResponsesCount As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Response icon",
                                    varOOBTextId: "imgActiveDiscussionResponsesCount__locAccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Height: =32
                        Image: |-
                            =If(
                                gblThemeDark || gblThemeHiCo,
                                Chat_Dark,
                                Chat
                            )
                        PaddingBottom: =8
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =8
                        Tooltip: =Self.AccessibleLabel
                        Width: =32
                        X: =Parent.Width - Self.Width - btnActiveDiscussionUpVotes.Width - 40
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnActiveDiscussionBackground.Y + (btnActiveDiscussionBackground.Height - Self.Height) / 2,
                                lblActiveDiscussionCreatedBy.Y + lblActiveDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =4

                    lblActiveDiscussionResponsesCount As label:
                        Align: =Align.Right
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingTop: =0
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: =ThisItem.NumberOfResponses
                        Width: =50
                        X: =imgActiveDiscussionResponsesCount.X - Self.Width + 5
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnActiveDiscussionBackground.Y + (btnActiveDiscussionBackground.Height - Self.Height) / 2,
                                lblActiveDiscussionCreatedBy.Y + lblActiveDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =5

                    txtActiveDiscussionTopic As text:
                        AccessibleLabel: =Self.Text
                        Align: =Align.Center
                        BorderColor: =gblAppStyles.TextInput.BorderColor
                        BorderThickness: =gblAppStyles.TextInput.BorderThickness
                        Color: =gblAppStyles.TextInput.Color
                        Default: =ThisItem.DiscussionRecord.'Discussion Topic'.Name
                        DisabledBorderColor: =gblAppStyles.TextInput.DisabledBorderColor
                        DisabledColor: |-
                            =If(
                                gblThemeDark || gblThemeHiCo,
                                gblAppStyles.Background.Fill,
                                gblAppStyles.Label.Color
                            )
                        DisabledFill: |-
                            =If(
                                gblThemeDark || gblThemeHiCo,
                                ColorValue("#BDBDE6"),
                                ColorValue("#E5E5F1")
                            )
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =gblAppStyles.TextInput.Fill
                        FocusedBorderColor: =gblAppStyles.TextInput.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.TextInput.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =32*1
                        HintText: =""
                        HoverBorderColor: =gblAppStyles.TextInput.HoverBorderColor
                        HoverColor: =gblAppStyles.TextInput.HoverColor
                        HoverFill: =gblAppStyles.TextInput.HoverFill
                        PaddingLeft: =5
                        PressedBorderColor: =gblAppStyles.TextInput.PressedBorderColor
                        PressedColor: =gblAppStyles.TextInput.PressedColor
                        PressedFill: =gblAppStyles.TextInput.PressedFill
                        RadiusBottomLeft: =gblAppStyles.ButtonTransparent.RadiusBottomLeft
                        RadiusBottomRight: =gblAppStyles.ButtonTransparent.RadiusBottomRight
                        RadiusTopLeft: =gblAppStyles.ButtonTransparent.RadiusTopLeft
                        RadiusTopRight: =gblAppStyles.ButtonTransparent.RadiusTopRight
                        Size: =gblAppStyles.TextInput.Size
                        TabIndex: =-1
                        Tooltip: =Self.Text
                        Width: |-
                            =If(
                                gblUserLanguage = "en-US",
                                Sum(
                                    AddColumns(
                                        Split(
                                            Self.Text,
                                            ""
                                        ),
                                        "Size",
                                        LookUp(
                                            colCharWidth,
                                            CharFont = Self.Font && CharWeight = Self.FontWeight && Char = Result
                                        ).Size
                                    ),
                                    Size
                                ) * Self.Size + Self.PaddingLeft + Self.PaddingRight + 10,
                                Min(
                                    100,
                                    Sum(
                                        AddColumns(
                                            Split(
                                                Self.Text,
                                                ""
                                            ),
                                            "Size",
                                            LookUp(
                                                colCharWidth,
                                                CharFont = Self.Font && CharWeight = Self.FontWeight && Char = Result
                                            ).Size
                                        ),
                                        Size
                                    ) * Self.Size + Self.PaddingLeft + Self.PaddingRight + 10
                                )
                            ) + 40
                        X: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                lblActiveDiscussionResponsesCount.X - Self.Width,
                                27 * 1
                            )
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnActiveDiscussionBackground.Y + (btnActiveDiscussionBackground.Height - Self.Height) / 2,
                                lblActiveDiscussionCreatedBy.Y + lblActiveDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =6

                    btnActiveDiscussionForeground As button:
                        BorderColor: =Transparent
                        BorderThickness: =0
                        Color: =Transparent
                        DisabledBorderColor: =Transparent
                        DisabledColor: =Transparent
                        DisabledFill: =Transparent
                        Fill: =Transparent
                        FocusedBorderColor: =gblAppStyles.TextInput.FocusedBorderColor
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Height: =btnActiveDiscussionBackground.Height
                        HoverBorderColor: =Transparent
                        HoverColor: =Transparent
                        HoverFill: =gblAppStyles.Gallery.HoverFill
                        OnSelect: =Select(Parent)
                        PressedBorderColor: =Transparent
                        PressedColor: =Transparent
                        PressedFill: =Transparent
                        Text: |-
                            =With(
                                {
                                    varDefault: "Click to select perspective",
                                    varOOBTextId: "btnActiveDiscussionForeground__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Tooltip: =ThisItem.DiscussionRecord.Description
                        Width: =btnActiveDiscussionBackground.Width
                        X: =btnActiveDiscussionBackground.X
                        Y: =btnActiveDiscussionBackground.Y
                        ZIndex: =7

                    imgActiveDiscussionUpVotes As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Upvote icon",
                                    varOOBTextId: "imgActiveDiscussionUpVotes__locAccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Height: =btnActiveDiscussionUpVotes.Height
                        Image: |-
                            =If(
                                IsBlank(
                                    LookUp(
                                        ThisItem.DiscussionRecord.'Discussion Upvotes',
                                        'Created By'.User = gblCurrUser.User
                                    )
                                )
                                /*
                                IsBlank(
                                    LookUp(
                                        'Discussion Upvotes',
                                        Discussion.Discussion = ThisItem.DiscussionRecord.Discussion && 'Created By'.User = gblCurrUser.User
                                    )
                                )
                                */,
                                With(
                                    {
                                        varImageRecord: LookUp(
                                            staticIcons,
                                            staticIconName = "Thumbs up unfilled"
                                        ),
                                        varColor: If(
                                            Self.DisplayMode = DisplayMode.Disabled,
                                            gblAppStyles.Icons.DisabledColor,
                                            gblAppStyles.Icons.Color
                                        )
                                    },
                                    With(
                                        {
                                            varImageData: Concatenate(
                                                "data:image/svg+xml;utf8, ",
                                                EncodeUrl(
                                                    Concatenate(
                                                        "<svg viewBox='",
                                                        varImageRecord.staticIconViewbox,
                                                        "' xmlns='http://www.w3.org/2000/svg'><path d='",
                                                        varImageRecord.staticIconPath,
                                                        "' fill='#",
                                                        varColor,
                                                        "'/></svg>"
                                                    )
                                                )
                                            )
                                        },
                                        varImageData
                                    )
                                ),
                                With(
                                    {
                                        varImageRecord: LookUp(
                                            staticIcons,
                                            staticIconName = "Thumbs up filled"
                                        ),
                                        varColor: If(
                                            Self.DisplayMode = DisplayMode.Disabled,
                                            gblAppStyles.Icons.DisabledColor,
                                            gblAppStyles.Icons.Color
                                        )
                                    },
                                    With(
                                        {
                                            varImageData: Concatenate(
                                                "data:image/svg+xml;utf8, ",
                                                EncodeUrl(
                                                    Concatenate(
                                                        "<svg viewBox='",
                                                        varImageRecord.staticIconViewbox,
                                                        "' xmlns='http://www.w3.org/2000/svg'><path d='",
                                                        varImageRecord.staticIconPath,
                                                        "' fill='#",
                                                        varColor,
                                                        "'/></svg>"
                                                    )
                                                )
                                            )
                                        },
                                        varImageData
                                    )
                                )
                            )
                        OnSelect: |-
                            =If(
                                IsError(
                                    Patch(
                                        'Discussion Upvotes',
                                        Defaults('Discussion Upvotes'),
                                        {
                                            Name: "Discussion upvote",
                                            Discussion: ThisItem.DiscussionRecord
                                        }
                                    )
                                ),
                                Notify("There was a problem saving your data. Please try again")
                            )
                        PaddingBottom: =8
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =8
                        TabIndex: |-
                            =If(
                                true,
                                -1,
                                0
                            )
                        Tooltip: =Self.AccessibleLabel
                        Width: =60
                        X: |-
                            =If(
                                Value(btnActiveDiscussionUpVotes.Text) > 9, btnActiveDiscussionUpVotes.X + 8, btnActiveDiscussionUpVotes.X + 6)
                        Y: =btnActiveDiscussionUpVotes.Y
                        ZIndex: =8

                    btnActiveDiscussionUpVotes As button:
                        BorderColor: =gblAppStyles.ButtonSecondary.BorderColor
                        BorderThickness: =gblAppStyles.ButtonSecondary.BorderThickness
                        Color: =gblAppStyles.ButtonSecondary.Color
                        DisabledBorderColor: =gblAppStyles.ButtonSecondary.DisabledBorderColor
                        DisabledColor: =gblAppStyles.ButtonSecondary.DisabledColor
                        DisabledFill: =gblAppStyles.ButtonSecondary.DisabledFill
                        Fill: =Transparent
                        FocusedBorderColor: =gblAppStyles.TextInput.FocusedBorderColor
                        FocusedBorderThickness: =1//gblAppStyles.ButtonSecondary.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.ButtonSecondary.HoverBorderColor
                        HoverColor: =gblAppStyles.ButtonSecondary.HoverColor
                        HoverFill: =Transparent
                        OnSelect: |-
                            =If(
                                IsBlank(
                                    LookUp(
                                        'Discussion Upvotes',
                                        Discussion.Discussion = ThisItem.DiscussionRecord.Discussion && 'Created By'.User = gblCurrUser.User
                                    )
                                ),
                                If(
                                    IsError(
                                        Patch(
                                            'Discussion Upvotes',
                                            Defaults('Discussion Upvotes'),
                                            {
                                                Name: "Discussion upvote",
                                                Discussion: ThisItem.DiscussionRecord
                                            }
                                        )
                                    ),
                                    Notify("There was a problem saving your data. Please try again")
                                ),
                                If(
                                    IsError(
                                        Remove(
                                            'Discussion Upvotes',
                                            LookUp(
                                                'Discussion Upvotes',
                                                Discussion.Discussion = ThisItem.DiscussionRecord.Discussion && 'Created By'.User = gblCurrUser.User
                                            )
                                        )
                                    ),
                                    Notify("There was a problem saving your data. Please try again")
                                )
                            )
                        PaddingRight: |-
                            =If(
                                Value(Self.Text) > 9,
                                22,
                                20
                            )
                        PressedBorderColor: =gblAppStyles.ButtonSecondary.PressedBorderColor
                        PressedColor: =gblAppStyles.ButtonSecondary.PressedColor
                        PressedFill: =Transparent
                        RadiusBottomLeft: =gblAppStyles.ButtonSecondary.RadiusBottomLeft
                        RadiusBottomRight: =gblAppStyles.ButtonSecondary.RadiusBottomRight
                        RadiusTopLeft: =gblAppStyles.ButtonSecondary.RadiusTopLeft
                        RadiusTopRight: =gblAppStyles.ButtonSecondary.RadiusTopRight
                        Size: =gblAppStyles.ButtonSecondary.Size
                        Text: |-
                            =With(
                                {varRows: ThisItem.DiscussionRecord.'Discussion Upvotes'},
                                Coalesce(
                                    CountRows(varRows),
                                    0
                                )
                            )
                            /*
                            // N+1 Data Call
                            Coalesce(
                                CountRows(
                                    Filter(
                                        'Discussion Upvotes',
                                        Discussion.Discussion = ThisItem.DiscussionRecord.Discussion
                                    )
                                ),
                                0
                            )
                            */
                        Tooltip: =Self.Text
                        Width: =56
                        X: =btnActiveDiscussionBackground.Width - Self.Width - 10
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnActiveDiscussionBackground.Y + (btnActiveDiscussionBackground.Height - Self.Height) / 2,
                                lblActiveDiscussionCreatedBy.Y + lblActiveDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =9

                lblActiveDiscusionsHeader As label:
                    AutoHeight: =true
                    BorderColor: =gblAppStyles.Label.BorderColor
                    BorderThickness: =gblAppStyles.Label.BorderThickness
                    Color: =gblAppStyles.Label.Color
                    DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                    DisabledColor: =gblAppStyles.Label.DisabledColor
                    DisabledFill: =gblAppStyles.Label.DisabledFill
                    Fill: =gblAppStyles.Label.Fill
                    FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                    FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =32*1
                    HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                    HoverColor: =gblAppStyles.Label.HoverColor
                    HoverFill: =gblAppStyles.Label.HoverFill
                    PaddingLeft: =25
                    PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                    PressedColor: =gblAppStyles.Label.PressedColor
                    PressedFill: =gblAppStyles.Label.PressedFill
                    Size: =gblAppStyles.Label.Size.Large
                    Text: |-
                        =With(
                            {
                                varDefault: "Most active discussions",
                                varOOBTextId: "lblActiveDiscusionsHeader__locText"
                            },
                            With(
                                {
                                    varLocalizedText: LookUp(
                                        colLocalization,
                                        OOBTextID = varOOBTextId,
                                        LocalizedText
                                    )
                                },
                                Coalesce(
                                    varLocalizedText,
                                    varDefault
                                )
                            )
                        )
                    Tooltip: =Self.Text
                    Visible: =CountRows(galActiveDiscussions.AllItems)>0
                    Width: |-
                        =If(
                            'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                            Parent.Width,
                            Parent.Width - 20*2
                        )
                    X: =lblTopicsHeader.X
                    Y: =galNewDiscussions.Y + galNewDiscussions.Height + 7
                    ZIndex: =3

                galNewDiscussions As gallery.galleryVertical:
                    AccessibleLabel: ="Gallery of New discussions"
                    FocusedBorderThickness: =1
                    Height: =Self.TemplateHeight * CountRows(Self.AllItems)
                    Items: |-
                        =FirstN(
                            Sort(
                                Discussions,
                                'Created On',
                                Descending
                            ),
                            3
                        )
                    Layout: =Layout.Vertical
                    OnSelect: |-
                        =UpdateContext({locSelectedDiscussion: ThisItem});
                        UpdateContext(
                            {
                                locSelectedDiscussionCreatedByUserFullName: LookUp(
                                    Users,
                                    User = locSelectedDiscussion.'Created By'.User,
                                    'Full Name'
                                )
                            }
                        );
                        Navigate(
                            'Responses Screen',
                            ScreenTransition.Fade,
                            {
                                locSelectedDiscussion: locSelectedDiscussion,
                                locSelectedDiscussionCreatedByUserFullName: locSelectedDiscussionCreatedByUserFullName,
                                locNavFromTopic: true
                            }
                        )
                    TabIndex: =0
                    TemplatePadding: =0
                    TemplateSize: |-
                        =If(
                            'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                            99 * 1,
                            141 * 1
                        )
                    Width: =galTopics.Width
                    X: =galTopics.X
                    Y: =lblNewDiscusionsHeader.Y + lblNewDiscusionsHeader.Height + 15
                    ZIndex: =4

                    btnNewDiscussionBackground As button:
                        BorderThickness: =0
                        Color: =Transparent
                        DisabledBorderColor: =Self.BorderColor
                        DisabledColor: =Self.Color
                        DisabledFill: =Self.Fill
                        Fill: |-
                            =If(
                                gblThemeDark,
                                gblAppColors.NeutralWebGray220,
                                gblThemeHiCo,
                                Black,
                                White
                            )
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Height: =Parent.TemplateHeight - 18
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =Self.Fill
                        OnSelect: =Select(Parent)
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =Self.Color
                        PressedFill: =Self.Fill
                        RadiusBottomLeft: =4
                        RadiusBottomRight: =4
                        RadiusTopLeft: =4
                        RadiusTopRight: =4
                        Size: =gblAppStyles.ButtonTransparent.Size
                        TabIndex: =-1
                        Text: |-
                            =With(
                                {
                                    varDefault: "Background button for the discussion",
                                    varOOBTextId: "btnNewDiscussionBackground__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Tooltip: =Self.Text
                        Width: =Parent.Width - Self.X*2
                        X: =5*1
                        Y: =5*1
                        ZIndex: =1

                    lblNewDiscussionName As label:
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingTop: =10
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: =ThisItem.Name
                        VerticalAlign: =VerticalAlign.Bottom
                        Width: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                txtNewDiscussionTopic.X - 20,
                                Parent.Width - Self.X*2
                            )
                        Wrap: =false
                        X: =5*1
                        Y: =12*1
                        ZIndex: =2

                    lblNewDiscussionCreatedBy As label:
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Small
                        Text: |-
                            =ThisItem.'Created By'.'Full Name' & " " & Text(
                                ThisItem.'Created On',
                                "[$-en-US]mm/dd"
                            )
                        VerticalAlign: =VerticalAlign.Top
                        Width: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                txtNewDiscussionTopic.X - 20,
                                Parent.Width - Self.X*2
                            )
                        Wrap: =false
                        X: =5*1
                        Y: =lblNewDiscussionName.Y + lblNewDiscussionName.Height
                        ZIndex: =3

                    imgNewDiscussionResponsesCount As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Response icon",
                                    varOOBTextId: "imgNewDiscussionResponsesCount__locAccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Height: =32
                        Image: |-
                            =If(
                                gblThemeDark || gblThemeHiCo,
                                Chat_Dark,
                                Chat
                            )
                        PaddingBottom: =8
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =8
                        Tooltip: =Self.AccessibleLabel
                        Width: =32
                        X: =Parent.Width - Self.Width - btnNewDiscussionUpVotes.Width - 40
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnNewDiscussionBackground.Y + (btnNewDiscussionBackground.Height - Self.Height) / 2,
                                lblNewDiscussionCreatedBy.Y + lblNewDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =4

                    lblNewDiscussionResponsesCount As label:
                        Align: =Align.Right
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =20
                        PaddingTop: =0
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: |-
                            =// Switched to relative count, older N+1 call is below
                            With(
                                {varCount: ThisItem.'Discussion Responses'},
                                CountRows(varCount)
                            )
                            /*
                            CountRows(
                                Filter(
                                    'Discussion Responses',
                                    Discussion.Discussion = ThisItem.Discussion
                                )
                            )
                            */
                        Width: =50
                        X: =imgNewDiscussionResponsesCount.X - Self.Width + 5
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnNewDiscussionBackground.Y + (btnNewDiscussionBackground.Height - Self.Height) / 2,
                                lblNewDiscussionCreatedBy.Y + lblNewDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =5

                    txtNewDiscussionTopic As text:
                        AccessibleLabel: =If('Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,Self.Text,"")
                        Align: =Align.Center
                        BorderColor: =gblAppStyles.TextInput.BorderColor
                        BorderThickness: =gblAppStyles.TextInput.BorderThickness
                        Clear: =true
                        Color: =gblAppStyles.TextInput.Color
                        Default: =ThisItem.'Discussion Topic'.Name
                        DisabledBorderColor: =gblAppStyles.TextInput.DisabledBorderColor
                        DisabledColor: |-
                            =If(
                                gblThemeDark || gblThemeHiCo,
                                gblAppStyles.Background.Fill,
                                gblAppStyles.Label.Color
                            )
                        DisabledFill: |-
                            =If(
                                gblThemeDark || gblThemeHiCo,
                                ColorValue("#BDBDE6"),
                                ColorValue("#E5E5F1")
                            )
                        DisplayMode: =DisplayMode.Disabled
                        Fill: =gblAppStyles.TextInput.Fill
                        FocusedBorderColor: =gblAppStyles.TextInput.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.TextInput.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =32*1
                        HintText: =""
                        HoverBorderColor: =gblAppStyles.TextInput.HoverBorderColor
                        HoverColor: =gblAppStyles.TextInput.HoverColor
                        HoverFill: =gblAppStyles.TextInput.HoverFill
                        PaddingLeft: =5
                        PressedBorderColor: =gblAppStyles.TextInput.PressedBorderColor
                        PressedColor: =gblAppStyles.TextInput.PressedColor
                        PressedFill: =gblAppStyles.TextInput.PressedFill
                        RadiusBottomLeft: =gblAppStyles.ButtonTransparent.RadiusBottomLeft
                        RadiusBottomRight: =gblAppStyles.ButtonTransparent.RadiusBottomRight
                        RadiusTopLeft: =gblAppStyles.ButtonTransparent.RadiusTopLeft
                        RadiusTopRight: =gblAppStyles.ButtonTransparent.RadiusTopRight
                        Size: =gblAppStyles.TextInput.Size
                        TabIndex: =-1
                        Width: |-
                            =If(
                                gblUserLanguage = "en-US",
                                Sum(
                                    AddColumns(
                                        Split(
                                            Self.Text,
                                            ""
                                        ),
                                        "Size",
                                        LookUp(
                                            colCharWidth,
                                            CharFont = Self.Font && CharWeight = Self.FontWeight && Char = Result
                                        ).Size
                                    ),
                                    Size
                                ) * Self.Size + Self.PaddingLeft + Self.PaddingRight + 10,
                                Min(
                                    100,
                                    Sum(
                                        AddColumns(
                                            Split(
                                                Self.Text,
                                                ""
                                            ),
                                            "Size",
                                            LookUp(
                                                colCharWidth,
                                                CharFont = Self.Font && CharWeight = Self.FontWeight && Char = Result
                                            ).Size
                                        ),
                                        Size
                                    ) * Self.Size + Self.PaddingLeft + Self.PaddingRight + 10
                                )
                            ) + If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                40,
                                0
                            )
                        X: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                lblNewDiscussionResponsesCount.X - Self.Width,
                                27 * 1
                            )
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnNewDiscussionBackground.Y + (btnNewDiscussionBackground.Height - Self.Height) / 2,
                                lblNewDiscussionCreatedBy.Y + lblNewDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =6

                    btnNewDiscussionForeground As button:
                        BorderColor: =Transparent
                        BorderThickness: =0
                        Color: =Transparent
                        DisabledBorderColor: =Transparent
                        DisabledColor: =Transparent
                        DisabledFill: =Transparent
                        Fill: =Transparent
                        FocusedBorderColor: =gblAppStyles.TextInput.FocusedBorderColor
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Height: =btnNewDiscussionBackground.Height
                        HoverBorderColor: =Transparent
                        HoverColor: =Transparent
                        HoverFill: =gblAppStyles.Gallery.HoverFill
                        OnSelect: =Select(Parent)
                        PressedBorderColor: =Transparent
                        PressedColor: =Transparent
                        PressedFill: =Transparent
                        Text: |-
                            =With(
                                {
                                    varDefault: "Click to select discussion",
                                    varOOBTextId: "btnNewDiscussionForeground__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Tooltip: =ThisItem.Description
                        Width: =btnNewDiscussionBackground.Width
                        X: =btnNewDiscussionBackground.X
                        Y: =btnNewDiscussionBackground.Y
                        ZIndex: =7

                    imgNewDiscussionUpVotes As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Upvote icon",
                                    varOOBTextId: "imgNewDiscussionUpVotes__locAccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Height: =btnNewDiscussionUpVotes.Height
                        Image: |-
                            =If(
                                IsBlank(
                                    LookUp(
                                        ThisItem.'Discussion Upvotes',
                                        'Created By'.User = gblCurrUser.User
                                    )
                                )
                                /*
                                IsBlank(
                                    LookUp(
                                        'Discussion Upvotes',
                                        Discussion.Discussion = ThisItem.Discussion && 'Created By'.User = gblCurrUser.User
                                    )
                                )
                                */,
                                With(
                                    {
                                        varImageRecord: LookUp(
                                            staticIcons,
                                            staticIconName = "Thumbs up unfilled"
                                        ),
                                        varColor: If(
                                            Self.DisplayMode = DisplayMode.Disabled,
                                            gblAppStyles.Icons.DisabledColor,
                                            gblAppStyles.Icons.Color
                                        )
                                    },
                                    With(
                                        {
                                            varImageData: Concatenate(
                                                "data:image/svg+xml;utf8, ",
                                                EncodeUrl(
                                                    Concatenate(
                                                        "<svg viewBox='",
                                                        varImageRecord.staticIconViewbox,
                                                        "' xmlns='http://www.w3.org/2000/svg'><path d='",
                                                        varImageRecord.staticIconPath,
                                                        "' fill='#",
                                                        varColor,
                                                        "'/></svg>"
                                                    )
                                                )
                                            )
                                        },
                                        varImageData
                                    )
                                ),
                                With(
                                    {
                                        varImageRecord: LookUp(
                                            staticIcons,
                                            staticIconName = "Thumbs up filled"
                                        ),
                                        varColor: If(
                                            Self.DisplayMode = DisplayMode.Disabled,
                                            gblAppStyles.Icons.DisabledColor,
                                            gblAppStyles.Icons.Color
                                        )
                                    },
                                    With(
                                        {
                                            varImageData: Concatenate(
                                                "data:image/svg+xml;utf8, ",
                                                EncodeUrl(
                                                    Concatenate(
                                                        "<svg viewBox='",
                                                        varImageRecord.staticIconViewbox,
                                                        "' xmlns='http://www.w3.org/2000/svg'><path d='",
                                                        varImageRecord.staticIconPath,
                                                        "' fill='#",
                                                        varColor,
                                                        "'/></svg>"
                                                    )
                                                )
                                            )
                                        },
                                        varImageData
                                    )
                                )
                            )
                        OnSelect: |-
                            =If(
                                IsError(
                                    Patch(
                                        'Discussion Upvotes',
                                        Defaults('Discussion Upvotes'),
                                        {
                                            Name: "Discussion upvote",
                                            Discussion: ThisItem
                                        }
                                    )
                                ),
                                Notify("There was a problem saving your data. Please try again")
                            )
                        PaddingBottom: =8
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =8
                        TabIndex: |-
                            =If(
                                true,
                                -1,
                                0
                            )
                        Tooltip: =Self.AccessibleLabel
                        Width: =60
                        X: |-
                            =/*If(
                                Value(btnNewDiscussionUpVotes.Text) > 9,
                                btnNewDiscussionUpVotes.X + 8,
                                btnNewDiscussionUpVotes.X + 6
                            )*/
                            btnNewDiscussionUpVotes.X + btnNewDiscussionUpVotes.Width-55
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnNewDiscussionBackground.Y + (btnNewDiscussionBackground.Height - Self.Height) / 2,
                                lblNewDiscussionCreatedBy.Y + lblNewDiscussionCreatedBy.Height + 5
                            )
                        ZIndex: =8

                    btnNewDiscussionUpVotes As button:
                        Align: =Align.Left
                        BorderColor: =gblAppStyles.ButtonSecondary.BorderColor
                        BorderThickness: =gblAppStyles.ButtonSecondary.BorderThickness
                        Color: =gblAppStyles.ButtonSecondary.Color
                        DisabledBorderColor: =gblAppStyles.ButtonSecondary.DisabledBorderColor
                        DisabledColor: =gblAppStyles.ButtonSecondary.DisabledColor
                        DisabledFill: =gblAppStyles.ButtonSecondary.DisabledFill
                        Fill: =Transparent
                        FocusedBorderColor: =gblAppStyles.ButtonSecondary.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.ButtonSecondary.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =29
                        HoverBorderColor: =gblAppStyles.ButtonSecondary.HoverBorderColor
                        HoverColor: =gblAppStyles.ButtonSecondary.HoverColor
                        HoverFill: =Transparent
                        OnSelect: |-
                            =If(
                                IsBlank(
                                    LookUp(
                                        'Discussion Upvotes',
                                        Discussion.Discussion = ThisItem.Discussion && 'Created By'.User = gblCurrUser.User
                                    )
                                ),
                                If(
                                    IsError(
                                        Patch(
                                            'Discussion Upvotes',
                                            Defaults('Discussion Upvotes'),
                                            {
                                                Name: "Discussion upvote",
                                                Discussion: ThisItem
                                            }
                                        )
                                    ),
                                    Notify("There was a problem saving your data. Please try again")
                                ),
                                If(
                                    IsError(
                                        Remove(
                                            'Discussion Upvotes',
                                            LookUp(
                                                'Discussion Upvotes',
                                                Discussion.Discussion = ThisItem.Discussion && 'Created By'.User = gblCurrUser.User
                                            )
                                        )
                                    ),
                                    Notify("There was a problem saving your data. Please try again")
                                )
                            );
                            UpdateContext({locScreenReaderAnnouncedText:If(
                                IsBlank(
                                    LookUp(
                                        ThisItem.'Discussion Upvotes',
                                        'Created By'.User = gblCurrUser.User
                                    )
                                )
                                 
                                ,
                            "You have removed your vote",
                               "you have voted"
                            )})
                        PaddingRight: |-
                            =If(
                                Value(Self.Text) > 9,
                                22,
                                20
                            )
                        PressedBorderColor: =gblAppStyles.ButtonSecondary.PressedBorderColor
                        PressedColor: =gblAppStyles.ButtonSecondary.PressedColor
                        PressedFill: =Transparent
                        RadiusBottomLeft: =gblAppStyles.ButtonSecondary.RadiusBottomLeft
                        RadiusBottomRight: =gblAppStyles.ButtonSecondary.RadiusBottomRight
                        RadiusTopLeft: =gblAppStyles.ButtonSecondary.RadiusTopLeft
                        RadiusTopRight: =gblAppStyles.ButtonSecondary.RadiusTopRight
                        Size: =gblAppStyles.ButtonSecondary.Size
                        Text: |-
                            =With(
                                {varRows: ThisItem.'Discussion Upvotes'},
                                Coalesce(
                                    CountRows(varRows),
                                    0
                                )
                            )
                            /*
                            // N+1 Data Call
                            Coalesce(
                                CountRows(
                                    Filter(
                                        'Discussion Upvotes',
                                        Discussion.Discussion = ThisItem.Discussion
                                    )
                                ),
                                0
                            )
                            */ & Char(10) &
                              "Kudos"
                        Tooltip: =Self.Text
                        VerticalAlign: =VerticalAlign.Top
                        Width: =56
                        X: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnNewDiscussionBackground.Width - Self.Width - 10,
                                Parent.Width - Self.Width - 21
                            )
                        Y: =29
                        ZIndex: =9

                lblNewDiscusionsHeader As label:
                    AutoHeight: =true
                    BorderColor: =gblAppStyles.Label.BorderColor
                    BorderThickness: =gblAppStyles.Label.BorderThickness
                    Color: =gblAppStyles.Label.Color
                    DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                    DisabledColor: =gblAppStyles.Label.DisabledColor
                    DisabledFill: =gblAppStyles.Label.DisabledFill
                    Fill: =gblAppStyles.Label.Fill
                    FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                    FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =32*1
                    HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                    HoverColor: =gblAppStyles.Label.HoverColor
                    HoverFill: =gblAppStyles.Label.HoverFill
                    PaddingLeft: =25
                    PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                    PressedColor: =gblAppStyles.Label.PressedColor
                    PressedFill: =gblAppStyles.Label.PressedFill
                    Size: =gblAppStyles.Label.Size.Large
                    Text: |-
                        =With(
                            {
                                varDefault: "New discussions",
                                varOOBTextId: "lblNewDiscusionsHeader__locText"
                            },
                            With(
                                {
                                    varLocalizedText: LookUp(
                                        colLocalization,
                                        OOBTextID = varOOBTextId,
                                        LocalizedText
                                    )
                                },
                                Coalesce(
                                    varLocalizedText,
                                    varDefault
                                )
                            )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =If(
                            'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                            Parent.Width,
                            Parent.Width - 20*2
                        )
                    X: =lblTopicsHeader.X
                    Y: =galTopics.Y + galTopics.Height + 20
                    ZIndex: =5

                galTopics As gallery.galleryHorizontal:
                    AccessibleLabel: ="Gallery of all topics"
                    BorderColor: =gblAppStyles.ButtonSecondary.FocusedBorderColor
                    FocusedBorderThickness: =1
                    Height: =32*8 + 20
                    Items: |-
                        =Search(
                            Sort(
                                'Discussion Topics',
                                Sequence,
                                Ascending
                            ),
                            txtFindTopics.Text,
                            "msft_name"
                        )
                    OnSelect: |-
                        =UpdateContext({locSelectedTopic: ThisItem});
                        Navigate(
                            'Discussions Screen',
                            ScreenTransition.Fade,
                            {locSelectedTopic: locSelectedTopic}
                        )
                    ShowNavigation: =true
                    ShowScrollbar: =false
                    TabIndex: =0
                    TemplatePadding: =0
                    Width: =Parent.Width - Self.X*2
                    X: =20*1
                    Y: |-
                        =If(
                            'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                            lblTopicsHeader.Y + lblTopicsHeader.Height + 5,
                            btnAddTopic.Y + btnAddTopic.Height + 20
                        )
                    ZIndex: =6

                    btnTopicBackground As button:
                        BorderThickness: =1
                        Color: =Transparent
                        DisabledBorderColor: =Self.BorderColor
                        DisabledColor: =Self.Color
                        DisabledFill: =Self.Fill
                        Fill: |-
                            =If(
                                gblThemeDark,
                                gblAppColors.NeutralWebGray220,
                                gblThemeHiCo,
                                Black,
                                White
                            )
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Height: =32*8 + 10
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =Self.Fill
                        OnSelect: =Select(Parent)
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =Self.Color
                        PressedFill: =Self.Fill
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Size: =gblAppStyles.ButtonTransparent.Size
                        TabIndex: =-1
                        Text: |-
                            =With(
                                {
                                    varDefault: "Background button for the topic",
                                    varOOBTextId: "btnTopicBackground__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Tooltip: =Self.Text
                        Width: =Parent.TemplateWidth - Self.X*2 - 8
                        X: =5*1
                        Y: =5*1
                        ZIndex: =1

                    lblTopicName As label:
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =10
                        PaddingTop: =0
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: =ThisItem.Name
                        Width: =btnTopicBackground.Width
                        X: =imgTopicCoverImage.X
                        Y: =imgTopicCoverImage.Y + imgTopicCoverImage.Height
                        ZIndex: =2

                    lblTopicDescription As label:
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =32*2
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =0
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: =ThisItem.Description
                        VerticalAlign: =VerticalAlign.Top
                        Width: =btnTopicBackground.Width
                        X: =imgTopicCoverImage.X
                        Y: =lblTopicName.Y + lblTopicName.Height
                        ZIndex: =4

                    imgTopicCoverImage As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Topic's Cover image ",
                                    varOOBTextId: "imgTopicCoverImage__locAccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Fill: |-
                            =If(
                                IsBlank(ThisItem.'Cover Icon'),
                                Transparent,
                                If(
                                    gblThemeDark || gblThemeHiCo,
                                    ColorValue(ThisItem.'Cover Color Dark'),
                                    ColorValue(ThisItem.'Cover Color')
                                )
                            )
                        Height: |-
                            =If(
                                IsBlank(ThisItem.'Cover Icon'),
                                btnTopicBackground.Height * 1 / 2,
                                btnTopicBackground.Height * 1 / 2 //60 * 1
                            )
                        Image: |-
                            =If(
                                !IsBlank(ThisItem.'Cover Icon'), 
                                ThisItem.'Cover Icon',
                                !IsBlank(ThisItem.'Cover Stock'),
                                ThisItem.'Cover Stock',
                                ThisItem.'Cover Image'.Full
                            )
                        ImagePosition: |-
                            =If(
                                IsBlank(ThisItem.'Cover Icon'),
                                ImagePosition.Fill,
                                ImagePosition.Fit
                            )
                        OnSelect: =Select(Parent)
                        PaddingBottom: |-
                            =If(
                                IsBlank(ThisItem.'Cover Icon'),
                                0,
                                30
                            )
                        PaddingTop: |-
                            =If(
                                IsBlank(ThisItem.'Cover Icon'),
                                0,
                                30
                            )
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Tooltip: =Self.AccessibleLabel
                        Width: |-
                            =If(
                                IsBlank(ThisItem.'Cover Icon'),
                                btnTopicBackground.Width+ 1,
                                btnTopicBackground.Width+ 1 //60 * 1
                            )
                        X: =btnTopicBackground.X
                        Y: =btnTopicBackground.Y
                        ZIndex: =5

                    lblTopicDiscussionCount As label:
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        OnSelect: =Select(Parent)
                        PaddingBottom: =0
                        PaddingLeft: =10
                        PaddingTop: =0
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: |-
                            =// Switched to direct call, old N+1 below
                            With(
                                {varRows: ThisItem.Discussions},
                                CountRows(varRows)
                            )
                            /*
                            CountRows(
                                Filter(
                                    Discussions,
                                    'Discussion Topic'.'Discussion Topic' = ThisItem.'Discussion Topic'
                                )
                            )
                            */
                        Width: =lblTopicName.Width
                        X: =lblTopicName.X
                        Y: =lblTopicDescription.Y + lblTopicDescription.Height
                        ZIndex: =6

                    imgTopicDiscussionIcon As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Topic discussion icon",
                                    varOOBTextId: "imgTopicDiscussionIcon__locAccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Height: =20*1
                        Image: |-
                            =If(
                                gblThemeDark || gblThemeHiCo,
                                Comment,
                                Comment
                            )
                        OnSelect: =Select(Parent)
                        PaddingBottom: =4
                        PaddingLeft: =4
                        PaddingRight: =4
                        PaddingTop: =4
                        Tooltip: =Self.AccessibleLabel
                        Width: =20*1
                        X: =lblTopicDiscussionCount.X + 15 + If(Value(lblTopicDiscussionCount.Text) >= 10, 10, 5)
                        Y: =lblTopicDiscussionCount.Y + (lblTopicDiscussionCount.Height - Self.Height)/2 + 1
                        ZIndex: =7

                    btnTopicForeground As button:
                        BorderColor: =Transparent
                        BorderThickness: =0
                        Color: =Transparent
                        DisabledBorderColor: =Transparent
                        DisabledColor: =Transparent
                        DisabledFill: =Transparent
                        Fill: =Transparent
                        FocusedBorderColor: =gblAppStyles.ButtonTransparent.FocusedBorderColor
                        FocusedBorderThickness: =1
                        Font: =Font.'Segoe UI'
                        Height: =btnTopicBackground.Height
                        HoverBorderColor: =Transparent
                        HoverColor: =Transparent
                        HoverFill: =gblAppStyles.Gallery.HoverFill
                        OnSelect: |-
                            =UpdateContext({locSelectedTopic: ThisItem});
                            Navigate(
                                'Discussions Screen',
                                ScreenTransition.Fade,
                                {locSelectedTopic: locSelectedTopic}
                            )
                        PressedBorderColor: =Transparent
                        PressedColor: =Transparent
                        PressedFill: =Transparent
                        RadiusBottomLeft: =8
                        RadiusBottomRight: =8
                        RadiusTopLeft: =8
                        RadiusTopRight: =8
                        Text: |-
                            =With(
                                {
                                    varDefault: "Click to view the Topic",
                                    varOOBTextId: "btnTopicForeground__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                            & " " & ThisItem.Name &" " & ThisItem.Description & " with " & lblTopicDiscussionCount.Text & " discussions"
                        Tooltip: =ThisItem.Name& ThisItem.Description
                        Width: =btnTopicBackground.Width
                        X: =btnTopicBackground.X
                        Y: =5
                        ZIndex: =8

                lblZeroState_Topics As label:
                    Align: =Align.Center
                    BorderColor: =gblAppStyles.Label.BorderColor
                    BorderThickness: =gblAppStyles.Label.BorderThickness
                    Color: =gblAppStyles.Label.Color
                    DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                    DisabledColor: =gblAppStyles.Label.DisabledColor
                    DisabledFill: =gblAppStyles.Label.DisabledFill
                    Fill: =gblAppStyles.Label.Fill
                    FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                    FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                    Font: =Font.'Segoe UI'
                    Height: =32*1
                    HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                    HoverColor: =gblAppStyles.Label.HoverColor
                    HoverFill: =gblAppStyles.Label.HoverFill
                    PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                    PressedColor: =gblAppStyles.Label.PressedColor
                    PressedFill: =gblAppStyles.Label.PressedFill
                    Size: =gblAppStyles.Label.Size.Medium
                    Text: |-
                        =With(
                            {
                                varDefault: "No results found. Try a different search.",
                                varOOBTextId: "lblZeroState_Topics__locText"
                            },
                            With(
                                {
                                    varLocalizedText: LookUp(
                                        colLocalization,
                                        OOBTextID = varOOBTextId,
                                        LocalizedText
                                    )
                                },
                                Coalesce(
                                    varLocalizedText,
                                    varDefault
                                )
                            )
                        )
                    Tooltip: =Self.Text
                    Visible: =CountRows(galTopics.AllItems) = 0
                    Width: =Parent.Width
                    Wrap: =false
                    X: =(Parent.Width - Self.Width) / 2
                    Y: =imgZeroState_Topics.Y + imgZeroState_Topics.Height + 20
                    ZIndex: =7

                imgZeroState_Topics As image:
                    AccessibleLabel: |-
                        =With(
                            {
                                varDefault: "Image for No results found",
                                varOOBTextId: "imgZeroState_Topics__locAccessibleText"
                            },
                            With(
                                {
                                    varLocalizedText: LookUp(
                                        colLocalization,
                                        OOBTextID = varOOBTextId,
                                        LocalizedText
                                    )
                                },
                                Coalesce(
                                    varLocalizedText,
                                    varDefault
                                )
                            )
                        )
                    Height: =150
                    Image: =ZeroState_SearchResults
                    Tooltip: =Self.AccessibleLabel
                    Visible: =CountRows(galTopics.AllItems) = 0
                    Width: =150
                    X: =(Parent.Width - Self.Width) / 2
                    Y: =galTopics.Y + 20
                    ZIndex: =8

                lblTopicsHeader As label:
                    AutoHeight: =true
                    BorderColor: =gblAppStyles.Label.BorderColor
                    BorderThickness: =gblAppStyles.Label.BorderThickness
                    Color: =gblAppStyles.Label.Color
                    DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                    DisabledColor: =gblAppStyles.Label.DisabledColor
                    DisabledFill: =gblAppStyles.Label.DisabledFill
                    Fill: =gblAppStyles.Label.Fill
                    FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                    FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =32*1
                    HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                    HoverColor: =gblAppStyles.Label.HoverColor
                    HoverFill: =gblAppStyles.Label.HoverFill
                    PaddingLeft: =25
                    PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                    PressedColor: =gblAppStyles.Label.PressedColor
                    PressedFill: =gblAppStyles.Label.PressedFill
                    Size: =gblAppStyles.Label.Size.Large
                    Text: |-
                        =If(
                            IsBlank(txtFindTopics.Text),
                            With(
                            {
                                varDefault: "All topics",
                                varOOBTextId: "lblTopicsHeader__locText1"
                            },
                            With(
                                {
                                    varLocalizedText: LookUp(
                                        colLocalization,
                                        OOBTextID = varOOBTextId,
                                        LocalizedText
                                    )
                                },
                                Coalesce(
                                    varLocalizedText,
                                    varDefault
                                )
                            )
                        ),
                            With(
                            {
                                varDefault: "Search results",
                                varOOBTextId: "lblTopicsHeader__locText2"
                            },
                            With(
                                {
                                    varLocalizedText: LookUp(
                                        colLocalization,
                                        OOBTextID = varOOBTextId,
                                        LocalizedText
                                    )
                                },
                                Coalesce(
                                    varLocalizedText,
                                    varDefault
                                )
                            )
                        )
                        )
                    Tooltip: =Self.Text
                    Width: |-
                        =If(
                            'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                            Parent.Width,
                            Parent.Width - 20*2
                        )
                    X: =0*1
                    Y: =txtFindTopics.Y + txtFindTopics.Height + 20
                    ZIndex: =9

                imgSettings As image:
                    AccessibleLabel: |-
                        =With(
                            {
                                varDefault: "Settings icon",
                                varOOBTextId: "imgSettings__locAcccessibleText"
                            },
                            With(
                                {
                                    varLocalizedText: LookUp(
                                        colLocalization,
                                        OOBTextID = varOOBTextId,
                                        LocalizedText
                                    )
                                },
                                Coalesce(
                                    varLocalizedText,
                                    varDefault
                                )
                            )
                        )
                    DisabledFill: |-
                        =With(
                            {
                                varImageIsCategory: LookUp(
                                    staticIcons,
                                    staticIconName = "Settings"
                                ).staticIconIsCategory
                            },
                            If(
                                varImageIsCategory,
                                gblAppStyles.Icons.DisabledFill_Category,
                                Transparent
                            )
                        )
                    Fill: |-
                        =With(
                            {
                                varImageIsCategory: LookUp(
                                    staticIcons,
                                    staticIconName = "Settings"
                                ).staticIconIsCategory
                            },
                            If(
                                varImageIsCategory,
                                gblAppStyles.Icons.Fill_Category,
                                Transparent
                            )
                        )
                    Height: =22*1
                    Image: |-
                        =If(
                            gblThemeDark || gblThemeHiCo,
                            Settings_Dark,
                            Settings_Default
                        )
                    OnSelect: |-
                        =Navigate(
                            'Topics Screen',
                            ScreenTransition.Fade
                        )
                    PaddingBottom: =2
                    PaddingLeft: =2
                    PaddingRight: =2
                    PaddingTop: =2
                    TabIndex: =0
                    Tooltip: =Self.AccessibleLabel
                    Visible: =false
                    Width: =22*1
                    X: =Parent.Width - Self.Width - 20
                    Y: |-
                        =If(
                            'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                            btnAddTopic.Y + (btnAddTopic.Height - Self.Height) / 2,
                            imgUserPic.Y
                        )
                    ZIndex: =13

                grpWelcomeMessages As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =13

                    lblWelcomeGreeting As label:
                        Align: =Align.Center
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Bold
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Role: =TextRole.Heading1
                        Size: =gblAppStyles.Label.Size.Large
                        Text: |-
                            ="Good " & With(
                                {
                                    varTimeValueNow: Hour(Now()),
                                    varTimeValueMorning: 5,
                                    varTimeValueAfternoon: 12,
                                    varTimeValueEvening: 20
                                },
                                With(
                                    {
                                        varGreeting: If(
                                            varTimeValueNow >= varTimeValueMorning And varTimeValueNow < varTimeValueAfternoon,
                                            "morning",
                                            varTimeValueNow >= varTimeValueAfternoon And varTimeValueNow < varTimeValueEvening,
                                            "afternoon",
                                            "evening"
                                        )
                                    },
                                    varGreeting & ", " & gblCurrUser.'First Name' & "."
                                )
                            ) 
                        Tooltip: =Self.Text
                        Width: =Parent.Width - 20*2
                        Wrap: =false
                        X: =(Parent.Width - Self.Width) / 2
                        Y: =imgUserPic.Y + imgUserPic.Height + 10
                        ZIndex: =16

                    lblWelcomeMessage As label:
                        Align: =Align.Center
                        AutoHeight: =true
                        BorderColor: =gblAppStyles.Label.BorderColor
                        BorderThickness: =gblAppStyles.Label.BorderThickness
                        Color: =gblAppStyles.Label.Color
                        DisabledBorderColor: =gblAppStyles.Label.DisabledBorderColor
                        DisabledColor: =gblAppStyles.Label.DisabledColor
                        DisabledFill: =gblAppStyles.Label.DisabledFill
                        Fill: =gblAppStyles.Label.Fill
                        FocusedBorderColor: =gblAppStyles.Label.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.Label.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                32*1,
                                32*1
                            )
                        HoverBorderColor: =gblAppStyles.Label.HoverBorderColor
                        HoverColor: =gblAppStyles.Label.HoverColor
                        HoverFill: =gblAppStyles.Label.HoverFill
                        PressedBorderColor: =gblAppStyles.Label.PressedBorderColor
                        PressedColor: =gblAppStyles.Label.PressedColor
                        PressedFill: =gblAppStyles.Label.PressedFill
                        Size: =gblAppStyles.Label.Size.Medium
                        Text: |-
                            =With(
                                {
                                    varDefault: "Everyones perspective matters. Share yours and learn from others.",
                                    varOOBTextId: "lblWelcomeMessage__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Tooltip: =Self.Text
                        Width: |-
                            =//If('Topics Screen'.Size=ScreenSize.ExtraLarge||'Topics Screen'.Size=ScreenSize.Large, Parent .Width-20*2, Parent .Width-20*2)
                            Parent.Width - 20*2
                        X: =(Parent.Width - Self.Width) / 2
                        Y: =lblWelcomeGreeting.Y + lblWelcomeGreeting.Height
                        ZIndex: =17

                grpAddTopic As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =13

                    btnAddTopic As button:
                        BorderColor: =gblAppStyles.ButtonPrimary.BorderColor
                        BorderThickness: =gblAppStyles.ButtonPrimary.BorderThickness
                        Color: =gblAppStyles.ButtonPrimary.Color
                        DisabledBorderColor: =gblAppStyles.ButtonPrimary.DisabledBorderColor
                        DisabledColor: =gblAppStyles.ButtonPrimary.DisabledColor
                        DisabledFill: =gblAppStyles.ButtonPrimary.DisabledFill
                        Fill: =gblAppStyles.ButtonPrimary.Fill
                        FocusedBorderColor: =gblAppStyles.ButtonSecondary.FocusedBorderColor
                        FocusedBorderThickness: =2//gblAppStyles.ButtonPrimary.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =32*1
                        HoverBorderColor: =gblAppStyles.ButtonPrimary.HoverBorderColor
                        HoverColor: =gblAppStyles.ButtonPrimary.HoverColor
                        HoverFill: =gblAppStyles.ButtonPrimary.HoverFill
                        OnSelect: |-
                            =Navigate(
                                'Add Topic Screen',
                                ScreenTransition.Fade
                            )
                        PaddingLeft: =24
                        PressedBorderColor: =gblAppStyles.ButtonPrimary.PressedBorderColor
                        PressedColor: =gblAppStyles.ButtonPrimary.PressedColor
                        PressedFill: =gblAppStyles.ButtonPrimary.PressedFill
                        RadiusBottomLeft: =gblAppStyles.ButtonPrimary.RadiusBottomLeft
                        RadiusBottomRight: =gblAppStyles.ButtonPrimary.RadiusBottomRight
                        RadiusTopLeft: =gblAppStyles.ButtonPrimary.RadiusTopLeft
                        RadiusTopRight: =gblAppStyles.ButtonPrimary.RadiusTopRight
                        Size: =gblAppStyles.ButtonPrimary.Size
                        Text: |-
                            =With(
                                {
                                    varDefault: "Add a topic",
                                    varOOBTextId: "btnAddTopic__locText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Tooltip: =Self.Text
                        Visible: ='Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large
                        Width: =160*1
                        X: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                Parent.Width - Self.Width - 20, //Parent.Width - imgSettings.Width - Self.Width - 20 - 10,
                                20 * 1
                            )
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                imgUserPic.Y,
                                txtFindTopics.Y + txtFindTopics.Height + 20
                            )
                        ZIndex: =14

                    imgAddTopic As image:
                        AccessibleLabel: |-
                            =/*With(
                                {
                                    varDefault: "Add icon",
                                    varOOBTextId: "imgAddTopic__locAcccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )*/"Add topic Button"
                        Height: =22*1
                        Image: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                If(
                                    gblThemeDark || gblThemeHiCo,
                                    Add_Dark,
                                    Add_Dark
                                ),
                                    If(
                                    gblThemeDark || gblThemeHiCo,
                                    Add_Dark,
                                    Add_Default
                                )
                            )
                        OnSelect: |-
                            =Navigate(
                                'Add Topic Screen',
                                ScreenTransition.Fade
                            )
                        TabIndex: |-
                            =If(
                               'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                -1,
                                0
                            )
                        Tooltip: ="Add Topic Button"
                        Width: =22*1
                        X: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnAddTopic.X + 20,
                                Parent.Width - Self.Width - 20 
                            )
                        Y: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                btnAddTopic.Y + (btnAddTopic.Height - Self.Height) / 2,
                                imgSettings.Y
                            )
                        ZIndex: =15

                grpFindTopics As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =13

                    txtFindTopics As text:
                        AccessibleLabel: =If('Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,Self.HintText,"")
                        BorderColor: =gblAppStyles.TextInput.BorderColor
                        BorderThickness: =gblAppStyles.TextInput.BorderThickness
                        Color: =gblAppStyles.TextInput.Color
                        Default: =""
                        DisabledBorderColor: =gblAppStyles.TextInput.DisabledBorderColor
                        DisabledColor: =gblAppStyles.TextInput.DisabledColor
                        DisabledFill: =gblAppStyles.TextInput.DisabledFill
                        Fill: =gblAppStyles.TextInput.Fill
                        FocusedBorderColor: =gblAppStyles.TextInput.FocusedBorderColor
                        FocusedBorderThickness: =gblAppStyles.TextInput.FocusedBorderThickness
                        Font: =Font.'Segoe UI'
                        Height: =32*1
                        HintText: |-
                            =With(
                                {
                                    varDefault: "Find a topic",
                                    varOOBTextId: "txtFindTopics__locHintText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        HoverBorderColor: =gblAppStyles.TextInput.HoverBorderColor
                        HoverColor: =gblAppStyles.TextInput.HoverColor
                        HoverFill: =gblAppStyles.TextInput.HoverFill
                        PaddingBottom: =5*1
                        PaddingLeft: =32*1
                        PaddingRight: =5*1
                        PaddingTop: =5*1
                        PressedBorderColor: =gblAppStyles.TextInput.PressedBorderColor
                        PressedColor: =gblAppStyles.TextInput.PressedColor
                        PressedFill: =gblAppStyles.TextInput.PressedFill
                        RadiusBottomLeft: =gblAppStyles.TextInput.RadiusBottomLeft
                        RadiusBottomRight: =gblAppStyles.TextInput.RadiusBottomRight
                        RadiusTopLeft: =gblAppStyles.TextInput.RadiusTopLeft
                        RadiusTopRight: =gblAppStyles.TextInput.RadiusTopRight
                        Size: =gblAppStyles.TextInput.Size
                        Tooltip: =If('Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,Self.HintText,"")
                        Width: |-
                            =If(
                                'Topics Screen'.Size = ScreenSize.ExtraLarge || 'Topics Screen'.Size = ScreenSize.Large,
                                Parent.Width/2.5,
                                Parent.Width/2// - 20*2
                            )
                        X: =(Parent.Width - Self.Width) / 2
                        Y: =lblWelcomeMessage.Y + lblWelcomeMessage.Height + 10
                        ZIndex: =10

                    imgFindTopics As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Search icon",
                                    varOOBTextId: "imgFindTopics__locAcccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        DisabledFill: |-
                            =With(
                                {
                                    varImageIsCategory: LookUp(
                                        staticIcons,
                                        staticIconName = "Search"
                                    ).staticIconIsCategory
                                },
                                If(
                                    varImageIsCategory,
                                    gblAppStyles.Icons.DisabledFill_Category,
                                    Transparent
                                )
                            )
                        Fill: |-
                            =With(
                                {
                                    varImageIsCategory: LookUp(
                                        staticIcons,
                                        staticIconName = "Search"
                                    ).staticIconIsCategory
                                },
                                If(
                                    varImageIsCategory,
                                    gblAppStyles.Icons.Fill_Category,
                                    Transparent
                                )
                            )
                        Height: =22*1
                        Image: |-
                            =With(
                                {
                                    varImageRecord: LookUp(
                                        staticIcons,
                                        staticIconName = "Search"
                                    ),
                                    varColor: If(
                                        Self.DisplayMode = DisplayMode.Disabled,
                                        gblAppStyles.Icons.DisabledColor,
                                        gblAppStyles.Icons.Color 
                                    )
                                },
                                With(
                                    {
                                        varImageData: Concatenate(
                                            "data:image/svg+xml;utf8, ",
                                            EncodeUrl(
                                                Concatenate(
                                                    "<svg viewBox='",
                                                    varImageRecord.staticIconViewbox,
                                                    "' xmlns='http://www.w3.org/2000/svg'><path d='",
                                                    varImageRecord.staticIconPath,
                                                    "' fill='#",
                                                    varColor,
                                                    "'/></svg>"
                                                )
                                            )
                                        )
                                    },
                                    varImageData
                                )
                            )
                        PaddingBottom: =2
                        PaddingLeft: =2
                        PaddingRight: =2
                        PaddingTop: =2
                        RadiusBottomLeft: =5
                        RadiusBottomRight: =5
                        RadiusTopLeft: =5
                        RadiusTopRight: =5
                        TabIndex: |-
                            =If(
                                true,
                                -1,
                                0
                            )
                        Tooltip: =Self.AccessibleLabel
                        Visible: =IsBlank(txtFindTopics.Text)
                        Width: =22*1
                        X: =txtFindTopics.X + 5
                        Y: =txtFindTopics.Y + (txtFindTopics.Height - Self.Height) / 2
                        ZIndex: =11

                    imgClearFindTopics As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Clear search icon",
                                    varOOBTextId: "imgClearFindTopics__locAcccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        DisabledFill: |-
                            =With(
                                {
                                    varImageIsCategory: LookUp(
                                        staticIcons,
                                        staticIconName = "Search"
                                    ).staticIconIsCategory
                                },
                                If(
                                    varImageIsCategory,
                                    gblAppStyles.Icons.DisabledFill_Category,
                                    Transparent
                                )
                            )
                        Fill: |-
                            =With(
                                {
                                    varImageIsCategory: LookUp(
                                        staticIcons,
                                        staticIconName = "Search"
                                    ).staticIconIsCategory
                                },
                                If(
                                    varImageIsCategory,
                                    gblAppStyles.Icons.Fill_Category,
                                    Transparent
                                )
                            )
                        Height: =22*1
                        Image: |-
                            =With(
                                {
                                    varImageRecord: LookUp(
                                        staticIcons,
                                        staticIconName = "Dismiss"
                                    ),
                                    varColor: If(
                                        Self.DisplayMode = DisplayMode.Disabled,
                                        gblAppStyles.Icons.DisabledColor,
                                        gblAppStyles.Icons.Color 
                                    )
                                },
                                With(
                                    {
                                        varImageData: Concatenate(
                                            "data:image/svg+xml;utf8, ",
                                            EncodeUrl(
                                                Concatenate(
                                                    "<svg viewBox='",
                                                    varImageRecord.staticIconViewbox,
                                                    "' xmlns='http://www.w3.org/2000/svg'><path d='",
                                                    varImageRecord.staticIconPath,
                                                    "' fill='#",
                                                    varColor,
                                                    "'/></svg>"
                                                )
                                            )
                                        )
                                    },
                                    varImageData
                                )
                            )
                        OnSelect: =Reset(txtFindTopics)
                        PaddingBottom: =2
                        PaddingLeft: =2
                        PaddingRight: =2
                        PaddingTop: =2
                        RadiusBottomLeft: =5
                        RadiusBottomRight: =5
                        RadiusTopLeft: =5
                        RadiusTopRight: =5
                        TabIndex: |-
                            =If(
                                true,
                                -1,
                                0
                            )
                        Tooltip: =Self.AccessibleLabel
                        Visible: =!IsBlank(txtFindTopics.Text)
                        Width: =22*1
                        X: =txtFindTopics.X + 5
                        Y: =txtFindTopics.Y + (txtFindTopics.Height - Self.Height) / 2
                        ZIndex: =12

                grpUserPhoto As group:
                    Height: =5
                    Width: =5
                    X: =40
                    Y: =40
                    ZIndex: =18

                    shpUserPicDefault As circle:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Background for default user photo",
                                    varOOBTextId: "_translateCommon__DefaultUserPhotoBackground"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Fill: |-
                            =If(
                                gblThemeDark,
                                gblAppColors.NeutralWebGray220,
                                gblThemeHiCo,
                                Black,
                                White
                            )
                        Height: =Self.Width
                        TabIndex: |-
                            =If(
                                true,
                                -1,
                                0
                            )
                        Tooltip: =Self.AccessibleLabel
                        Width: =imgUserPicDefault.Width
                        X: =imgUserPicDefault.X 
                        Y: =imgUserPicDefault.Y
                        ZIndex: =2

                    imgUserPicDefault As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "Default user photo",
                                    varOOBTextId: "imgUserPicDefault__locAcccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Fill: |-
                            =If(
                                gblThemeDark,
                                gblAppColors.NeutralWebBlack,
                                gblThemeHiCo,
                                gblAppColors.NeutralWebBlack,
                                gblAppColors.NeutralWebWhite
                            )
                        Height: =imgUserPic.Height
                        Image: |-
                            =With(
                                {
                                    varImageRecord: LookUp(
                                        staticIcons,
                                        staticIconName = "Person"
                                    ),
                                    varColor: If(
                                        Self.DisplayMode = DisplayMode.Disabled,
                                        gblAppStyles.Icons.DisabledColor,
                                        gblAppStyles.Icons.Color
                                    )
                                },
                                With(
                                    {
                                        varImageData: Concatenate(
                                            "data:image/svg+xml;utf8, ",
                                            EncodeUrl(
                                                Concatenate(
                                                    "<svg viewBox='",
                                                    varImageRecord.staticIconViewbox,
                                                    "' xmlns='http://www.w3.org/2000/svg'><path d='",
                                                    varImageRecord.staticIconPath,
                                                    "' fill='#",
                                                    varColor,
                                                    "'/></svg>"
                                                )
                                            )
                                        )
                                    },
                                    varImageData
                                )
                            )
                        PaddingBottom: =10
                        PaddingLeft: =10
                        PaddingRight: =10
                        PaddingTop: =10
                        RadiusBottomLeft: =80*1
                        RadiusBottomRight: =80*1
                        RadiusTopLeft: =80*1
                        RadiusTopRight: =80*1
                        TabIndex: |-
                            =If(
                                true,
                                -1,
                                0
                            )
                        Tooltip: =Self.AccessibleLabel
                        Width: =imgUserPic.Width
                        X: =imgUserPic.X
                        Y: =imgUserPic.Y
                        ZIndex: =18

                    imgUserPic As image:
                        AccessibleLabel: |-
                            =With(
                                {
                                    varDefault: "User's profile photo",
                                    varOOBTextId: "imgUserPic__locAcccessibleText"
                                },
                                With(
                                    {
                                        varLocalizedText: LookUp(
                                            colLocalization,
                                            OOBTextID = varOOBTextId,
                                            LocalizedText
                                        )
                                    },
                                    Coalesce(
                                        varLocalizedText,
                                        varDefault
                                    )
                                )
                            )
                        Height: =Self.Width
                        Image: |-
                            =If(
                                !IsBlank(gblCurrUserEmail),
                                Office365Users.UserPhotoV2(gblCurrUserEmail)
                            )
                        RadiusBottomLeft: =80*1
                        RadiusBottomRight: =80*1
                        RadiusTopLeft: =80*1
                        RadiusTopRight: =80*1
                        TabIndex: |-
                            =If(
                                true,
                                -1,
                                0
                            )
                        Tooltip: =Self.AccessibleLabel
                        Width: =48*1
                        X: =(Parent.Width - Self.Width) / 2
                        Y: =20*1
                        ZIndex: =19

    grpTopicsCustomize As group:
        Height: =5
        Width: =5
        X: =40
        Y: =40
        ZIndex: =4

        btnCustomize_Topics As button:
            Align: =Align.Left
            BorderColor: =gblAppStyles.ButtonTransparent.BorderColor
            BorderThickness: =gblAppStyles.ButtonTransparent.BorderThickness
            Color: =gblAppStyles.ButtonTransparent.Color
            DisabledBorderColor: =gblAppStyles.ButtonTransparent.DisabledBorderColor
            DisabledColor: =gblAppStyles.ButtonTransparent.DisabledColor
            DisabledFill: =gblAppStyles.ButtonTransparent.DisabledFill
            Fill: |-
                =If(
                    gblThemeDark || gblThemeHiCo,
                    RGBA(
                        0,
                        0,
                        0,
                        0.7
                    ),
                    RGBA(
                        255,
                        255,
                        255,
                        0.7
                    )
                )
            FocusedBorderColor: =gblAppStyles.ButtonTransparent.FocusedBorderColor
            FocusedBorderThickness: =gblAppStyles.ButtonTransparent.FocusedBorderThickness
            Font: =Font.'Segoe UI'
            Height: =32*1
            HoverBorderColor: =gblAppStyles.ButtonTransparent.HoverBorderColor
            HoverColor: =gblAppStyles.ButtonTransparent.HoverColor
            HoverFill: =Self.Fill
            OnSelect: |-
                =//screen reader start
                UpdateContext(
                    {
                        locScreenReaderAnnouncedText: With(
                            {
                                varAnnouncedText: With(
                                    {
                                        varDefault: "Navigating to the about screen",
                                        varOOBTextId: "btnCustomize__locAnnouncement"
                                    },
                                    With(
                                        {
                                            varLocalizedText: LookUp(
                                                colLocalization,
                                                OOBTextID = varOOBTextId,
                                                LocalizedText
                                            )
                                        },
                                        Coalesce(
                                            varLocalizedText,
                                            varDefault
                                        )
                                    )
                                )
                            },
                            If(
                                locScreenReaderAnnouncedText = varAnnouncedText,
                                Concatenate(
                                    varAnnouncedText,
                                    " "
                                ),
                                varAnnouncedText
                            )
                        )
                    }
                );
                //screen reader end
                Navigate(
                    'About Screen',
                    ScreenTransition.Fade
                );
            PaddingBottom: =0
            PaddingLeft: =34
            PaddingTop: =0
            PressedBorderColor: =gblAppStyles.ButtonTransparent.PressedBorderColor
            PressedColor: =gblAppStyles.ButtonTransparent.PressedColor
            PressedFill: =Self.Fill
            RadiusBottomLeft: =gblAppStyles.ButtonTransparent.RadiusBottomLeft
            RadiusBottomRight: =gblAppStyles.ButtonTransparent.RadiusBottomRight
            RadiusTopLeft: =gblAppStyles.ButtonTransparent.RadiusTopLeft
            RadiusTopRight: =gblAppStyles.ButtonTransparent.RadiusTopRight
            Size: =gblAppStyles.ButtonTransparent.Size
            TabIndex: |-
                =If(
                    locShowFirstRun || locShowPowerAppsPrompt,
                    -1,
                    If(
                        Self.Visible,
                        0,
                        -1
                    )
                )
            Text: |-
                =With(
                    {
                        varDefault: "Built with Power Apps >",
                        varOOBTextId: "btnCustomize__locText"
                    },
                    With(
                        {
                            varLocalizedText: LookUp(
                                colLocalization,
                                OOBTextID = varOOBTextId,
                                LocalizedText
                            )
                        },
                        Coalesce(
                            varLocalizedText,
                            varDefault
                        )
                    )
                )
            Tooltip: |-
                =With(
                    {
                        varDefault: "Click to navigate to the about screen",
                        varOOBTextId: "btnCustomize__locTooltip"
                    },
                    With(
                        {
                            varLocalizedText: LookUp(
                                colLocalization,
                                OOBTextID = varOOBTextId,
                                LocalizedText
                            )
                        },
                        Coalesce(
                            varLocalizedText,
                            varDefault
                        )
                    )
                )
            Width: =200*1
            X: =Parent.Width - Self.Width - 20
            Y: =Parent.Height - Self.Height - 20
            ZIndex: =3

        imgCustomize_Topics As image:
            AccessibleLabel: |-
                =With(
                    {
                        varDefault: "Click to navigate to the About screen",
                        varOOBTextId: "btnCustomize__locTooltip"
                    },
                    With(
                        {
                            varLocalizedText: LookUp(
                                colLocalization,
                                OOBTextID = varOOBTextId,
                                LocalizedText
                            )
                        },
                        Coalesce(
                            varLocalizedText,
                            varDefault
                        )
                    )
                )
            DisabledFill: |-
                =With(
                    {
                        varImageIsCategory: LookUp(
                            staticIcons,
                            staticIconName = "Filter"
                        ).staticIconIsCategory
                    },
                    If(
                        varImageIsCategory,
                        gblAppStyles.Icons.DisabledFill_Category,
                        Transparent
                    )
                )
            Fill: |-
                =With(
                    {
                        varImageIsCategory: LookUp(
                            staticIcons,
                            staticIconName = "Filter"
                        ).staticIconIsCategory
                    },
                    If(
                        varImageIsCategory,
                        gblAppStyles.Icons.Fill_Category,
                        Transparent
                    )
                )
            Height: =22*1
            Image: |-
                =If(
                    gblThemeDark || gblThemeHiCo,
                    BuiltWithDark,
                    BuiltWith
                )
            OnSelect: |-
                =//screen reader start
                UpdateContext(
                    {
                        locScreenReaderAnnouncedText: With(
                            {
                                varAnnouncedText: With(
                                    {
                                        varDefault: "Navigating to the about screen",
                                        varOOBTextId: "btnCustomize__locAnnouncement"
                                    },
                                    With(
                                        {
                                            varLocalizedText: LookUp(
                                                colLocalization,
                                                OOBTextID = varOOBTextId,
                                                LocalizedText
                                            )
                                        },
                                        Coalesce(
                                            varLocalizedText,
                                            varDefault
                                        )
                                    )
                                )
                            },
                            If(
                                locScreenReaderAnnouncedText = varAnnouncedText,
                                Concatenate(
                                    varAnnouncedText,
                                    " "
                                ),
                                varAnnouncedText
                            )
                        )
                    }
                );
                //screen reader end
                Navigate(
                    'About Screen',
                    ScreenTransition.Fade
                );
            PaddingBottom: =2
            PaddingLeft: =2
            PaddingRight: =2
            PaddingTop: =2
            RadiusBottomLeft: =5
            RadiusBottomRight: =5
            RadiusTopLeft: =5
            RadiusTopRight: =5
            TabIndex: |-
                =If(
                    true,
                    -1,
                    0
                )
            Tooltip: =Self.AccessibleLabel
            Width: =22*1
            X: =btnCustomize_Topics.X + 10
            Y: =btnCustomize_Topics.Y + (btnCustomize_Topics.Height - Self.Height) / 2
            ZIndex: =4

